<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>Admin Panel</title>
</head>
<body>
<style>

  
  :root {
    --bg-gradient-main: linear-gradient(to bottom right, hsl(240, 1%, 25%) 3%, hsl(0, 0%, 19%) 97%);
    --bg-gradient-tab-active: linear-gradient(to bottom right, hsl(45, 100%, 71%) 0%, hsl(36, 100%, 69%) 100%);
    --bg-content: hsl(240, 1%, 20%);
    --bg-table-header: hsl(240, 1%, 25%);
    --bg-table-row: hsl(240, 1%, 15%);
    --text-main: hsl(0, 0%, 98%);
    --text-highlight: hsl(45, 100%, 72%);
    --border-light: hsl(0, 0%, 84%);
    --box-shadow: 0 8px 24px hsla(0, 0%, 0%, 0.25);
    --font-family: 'Poppins', sans-serif;
    --transition: 0.3s ease;
  }

  * {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
  }
  
  body {
    font-family: var(--font-family);
    background: hsl(0deg 0% 77.16%);
    color: var(--text-main);
    display: flex;
    justify-content: center;
    align-items: flex-start;
    min-height: 100vh;
    padding: 20px;
    width: 100%;
  }
  
  .admin-container {
    display: flex;
    gap: 20px;
    width: 100%;
    max-width: 1200px;
    flex-wrap: wrap; /* Cho phép các phần tử tự động chuyển sang dòng mới khi không đủ không gian */
  }
  
  .sidebar {
    width: 250px;
    background: var(--bg-content);
    color: var(--text-main);
    padding: 20px;
    border-radius: 12px;
    display: flex;
    flex-direction: column;
    gap: 15px;
    box-shadow: var(--box-shadow);
  }

  .sidebar button {
    background: none;
    color: var(--text-main);
    border: none;
    padding: 10px;
    text-align: left;
    font-size: 1rem;
    cursor: pointer;
    transition: background var(--transition);
  }
  
  .sidebar button:hover,
  .sidebar button.active {
    background: var(--bg-gradient-tab-active);
    border-radius: 8px;
  }
  
  .admin-header {
    background: #007bff;
    color: #fff;
    padding: 20px;
    text-align: center;
    border-radius: 12px;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
  }
  
  
  .admin-header h1 {
    font-size: 2.5rem;
  }
  
  /* Main Content */
  .admin-main {
    flex-grow: 1;
    background: var(--bg-content);
    border-radius: 12px;
    padding: 20px;
    box-shadow: var(--box-shadow);
    width: calc(100% - 280px); /* Chiều rộng main content trừ chiều rộng sidebar */
  }
  .tab-content {
    display: none;
  }
  
  .tab-content.active {
    display: block;
  }
  
  .card {
    background: var(--bg-content);
    border-radius: 12px;
    box-shadow: var(--box-shadow);
    padding: 20px;
    margin-bottom: 20px;
    color: var(--text-main);
  }
  
  .card h2 {
    font-size: 1.8rem;
    margin-bottom: 15px;
  }
  /* Form Section */
  .form-group {
    margin-bottom: 15px;
  }
  
  label {
    display: block;
    font-weight: bold;
    margin-bottom: 5px;
    color: var(--text-highlight);
  }
  
  input[type="text"],
  input[type="number"],
  input[type="file"] {
    width: 100%;
    padding: 10px;
    font-size: 1rem;
    border: 1px solid var(--border-light);
    border-radius: 8px;
    background: var(--bg-table-row);
    color: var(--text-main);
    transition: border-color var(--transition);
  }
  
  input:focus {
    border-color: var(--text-highlight);
    outline: none;
  }
  
  .form-actions {
    text-align: right;
  }
  
  .btn-primary {
    background: var(--bg-gradient-tab-active);
    color: var(--text-main);
    border: none;
    padding: 10px 15px;
    font-size: 1rem;
    border-radius: 8px;
    cursor: pointer;
    transition: transform var(--transition), box-shadow var(--transition);
  }
  
  .btn-primary:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 10px hsla(45, 100%, 50%, 0.5);
  }
  
  .product-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 20px;
  }
  
  .product-item {
    background: var(--bg-table-row);
    padding: 20px;
    border-radius: 12px;
    box-shadow: var(--box-shadow);
    text-align: center;
  }
  
  .product-item:hover {
    transform: translateY(-5px);
    box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
  }
  
  .product-item img {
    width: 100px;
    height: auto;
    margin-bottom: 10px;
    border-radius: 8px;
    border: 1px solid var(--border-light);
  }
  
  .product-item p {
    margin: 10px 0;
    font-size: 1rem;
  }
  
  button {
    background: linear-gradient(45deg, #dc3545, #a71d2a);
    color: #fff;
    border: none;
    padding: 8px 12px;
    font-size: 0.9rem;
    border-radius: 8px;
    cursor: pointer;
    transition: transform 0.2s ease, box-shadow 0.2s ease;
  }
  
  button:hover {
    transform: translateY(-3px);
    box-shadow: 0 4px 10px rgba(220, 53, 69, 0.3);
  }
  

  /* User List Section */
.user-list {
  display: flex;
  flex-direction: column;
  gap: 15px;
}

.user-item {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 10px 15px;
  background: #fff;
  border-radius: 8px;
  box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
  transition: transform 0.2s ease;
}

.user-item:hover {
  transform: translateY(-2px);
  box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
}

.user-item p {
  margin: 0;
  font-size: 1rem;
  color: #333;
}

.user-item button {
  margin-left: 10px;
  padding: 5px 10px;
  font-size: 0.9rem;
  background: #dc3545;
  color: #fff;
  border: none;
  border-radius: 5px;
  cursor: pointer;
  transition: background 0.3s ease, transform 0.2s ease;
}

.user-item button:hover {
  background: #a71d2a;
  transform: translateY(-2px);
}

#requests-container {
  display: table-cell;
      padding: 10px 15px;
      background: #fff;
      border-radius: 8px;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
      transition: transform 0.2s ease;
}

@media (max-width: 768px) {
  .admin-container {
    flex-direction: column;
    align-items: center;
  }

  .sidebar {
    width: 100%;
    margin-bottom: 20px;
  }

  .admin-main {
    width: 100%;
  }

  .card h2 {
    font-size: 1.5rem;
  }

  input[type="text"],
  input[type="number"],
  input[type="file"] {
    font-size: 0.9rem;
  }

  .btn-primary {
    font-size: 0.9rem;
    padding: 8px 12px;
  }

  .product-grid {
    grid-template-columns: 1fr 1fr;
  }
}

@media (max-width: 480px) {
  .admin-container {
    padding: 10px;
  }

  .sidebar {
    width: 100%;
    margin-bottom: 10px;
  }

  .admin-main {
    width: 100%;
  }

  .card h2 {
    font-size: 1.3rem;
  }

  input[type="text"],
  input[type="number"],
  input[type="file"] {
    font-size: 0.85rem;
  }

  .btn-primary {
    font-size: 0.85rem;
    padding: 8px 12px;
  }

  .product-grid {
    grid-template-columns: 1fr;
  }
}
</style>



<div class="admin-container">
  <!-- Sidebar -->
  <div class="sidebar">
    <button class="tab-link" data-tab="products">Quản lý sản phẩm</button>
    <button class="tab-link" data-tab="users">Quản lý người dùng</button>
    <button class="tab-link" data-tab="requests">Quản lý yêu cầu</button>
  </div>

  <!-- Main Content -->
  <main class="admin-main">

    <!-- Quản lý sản phẩm -->
    <div class="tab-content" id="products">
      <div class="card">
        <h2>Quản lý sản phẩm</h2>
        <form id="product-form">
          <div class="form-group">
            <label for="product-id">Product ID:</label>
            <input type="text" id="product-id" placeholder="Enter product ID" required>
          </div>
          <div class="form-group">
            <label for="product-title">Title:</label>
            <input type="text" id="product-title" placeholder="Enter product title" required>
          </div>
          <div class="form-group">
            <label for="product-category">Category:</label>
            <input type="text" id="product-category" placeholder="Enter category" required>
          </div>
          <div class="form-group">
            <label for="product-price">Price (VND):</label>
            <input type="number" id="product-price" placeholder="Enter price" required>
          </div>
          <div class="form-group">
            <label for="product-image-url">Image URL:</label>
            <input type="text" id="product-image-url" placeholder="Enter image URL">
          </div>
          <div class="form-group">
            <label for="product-image-file">Or Upload Image:</label>
            <input type="file" id="product-image-file" accept="image/*">
          </div>
          <div class="form-group">
            <label for="product-download-link">Download Link:</label>
            <input type="text" id="product-download-link" placeholder="Enter download link" required>
          </div>
          <div class="form-actions">
            <button type="submit" class="btn-primary">Save Product</button>
          </div>
        </form>

      <!-- Product List Section -->


      </div> 
           <section class="product-list-section">
        <div class="card">
          <h2>Product List</h2>
          <div id="product-list" class="product-grid"></div>
        </div>
      </section>
    </div>

    <!-- Quản lý người dùng -->
    <div class="tab-content" id="users">
      <div class="card">
        <h2>Quản lý người dùng</h2>
        <div id="user-list" class="user-list"></div>
      </div>
    </div>

    <!-- Quản lý yêu cầu -->
    <div class="tab-content" id="requests">
      <div class="card">
        <h2>Quản lý yêu cầu</h2>
        <div id="requests-container"></div>
      </div>
    </div>
  </main>
</div>



  
</body>
</html>

  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>


  <!-- sliderbar -->
  <script>
    const tabLinks = document.querySelectorAll(".tab-link");
    const tabContents = document.querySelectorAll(".tab-content");

    tabLinks.forEach(link => {
      link.addEventListener("click", () => {
        // Remove active class from all links and contents
        tabLinks.forEach(btn => btn.classList.remove("active"));
        tabContents.forEach(content => content.classList.remove("active"));

        // Add active class to clicked link and corresponding tab
        link.classList.add("active");
        const tabId = link.getAttribute("data-tab");
        document.getElementById(tabId).classList.add("active");
      });
    });
  </script>
<script>
  document.addEventListener("DOMContentLoaded", () => {
    const productForm = document.getElementById("product-form");
    const productList = document.getElementById("product-list");
    const imageFileInput = document.getElementById("product-image-file");
    const imageUrlInput = document.getElementById("product-image-url");
    const downloadLinkInput = document.getElementById("product-download-link");

    // Lấy dữ liệu từ localStorage
    const getProducts = () => JSON.parse(localStorage.getItem("products")) || [];

    // Lưu dữ liệu vào localStorage
    const saveProducts = (products) => localStorage.setItem("products", JSON.stringify(products));

    // Render danh sách sản phẩm
    const renderProducts = () => {
        const products = getProducts();
        productList.innerHTML = products
            .map(
                (product, index) => `
              <div class="product-item">
                <p><strong>${product.title}</strong> (${product.category})</p>
                <p>ID: ${product.id}</p>
                <p>Price: ${product.price} VND</p>
                <p>Download Link: <a href="${product.downloadLink}" target="_blank">Download</a></p>
                <img src="${product.image}" alt="${product.title}" style="width: 100px; height: auto;">
                <button onclick="editProduct(${index})">Edit</button>
                <button onclick="deleteProduct(${index})">Delete</button>
              </div>
            `
            )
            .join("");
    };

    // Xóa sản phẩm
    window.deleteProduct = (index) => {
        const products = getProducts();
        products.splice(index, 1);
        saveProducts(products);
        renderProducts();
    };

    // Chỉnh sửa sản phẩm
    window.editProduct = (index) => {
        const products = getProducts();
        const product = products[index];

        document.getElementById("product-id").value = product.id;
        document.getElementById("product-title").value = product.title;
        document.getElementById("product-category").value = product.category;
        document.getElementById("product-price").value = product.price;
        document.getElementById("product-image-url").value = product.image;
        document.getElementById("product-download-link").value = product.downloadLink;

        productForm.dataset.editIndex = index;
    };

    // Xử lý ảnh
    const processImage = () => {
        const file = imageFileInput.files[0];
        return new Promise((resolve) => {
            if (file) {
                const reader = new FileReader();
                reader.onload = (event) => resolve(event.target.result); // Base64 URL của ảnh
                reader.readAsDataURL(file);
            } else {
                resolve(imageUrlInput.value.trim()); // URL từ input
            }
        });
    };

    // Thêm hoặc cập nhật sản phẩm
    productForm.addEventListener("submit", async (e) => {
        e.preventDefault();

        const id = document.getElementById("product-id").value.trim();
        const title = document.getElementById("product-title").value.trim();
        const category = document.getElementById("product-category").value.trim();
        const price = document.getElementById("product-price").value.trim();
        const downloadLink = downloadLinkInput.value.trim();

        const image = await processImage(); // Xử lý ảnh từ tệp hoặc URL

        if (!image || !downloadLink) {
            alert("Please provide a valid image URL or upload an image file, and ensure the download link is not empty.");
            return;
        }

        const products = getProducts();
        const editIndex = productForm.dataset.editIndex;

        if (editIndex) {
            products[editIndex] = { id, title, category, price, image, downloadLink };
            delete productForm.dataset.editIndex;
        } else {
            products.push({ id, title, category, price, image, downloadLink });
        }

        saveProducts(products);
        renderProducts();
        productForm.reset();
    });

    renderProducts();
});

      
</script>

<script>
  
</script>


<script>
  document.addEventListener("DOMContentLoaded", () => {
    const productForm = document.getElementById("product-form");

    const saveProducts = (products) => localStorage.setItem("products", JSON.stringify(products));
    const getProducts = () => JSON.parse(localStorage.getItem("products")) || [];

    productForm.addEventListener("submit", (e) => {
      e.preventDefault();
      const id = document.getElementById("product-id").value.trim();
      const title = document.getElementById("product-title").value.trim();
      const category = document.getElementById("product-category").value.trim();
      const price = parseInt(document.getElementById("product-price").value.trim(), 10);
      const downloadLink = document.getElementById("product-download-link").value.trim();
      const products = getProducts();

      products.push({ id, title, category, price, downloadLink });
      saveProducts(products);

      Swal.fire({
        icon: "success",
        title: "Thành công!",
        text: "Sản phẩm đã được thêm.",
      });
      productForm.reset();
    });
  });
</script>

<script>
  document.addEventListener("DOMContentLoaded", () => {
    const userList = document.getElementById("user-list");

    // Tài khoản admin mặc định
    const adminAccount = { email: "admin@gmail.com", password: "admin123" };

    // Lấy và lưu tài khoản từ localStorage
    const getAccounts = () => JSON.parse(localStorage.getItem("accounts")) || [];
    const saveAccounts = (accounts) => localStorage.setItem("accounts", JSON.stringify(accounts));

    // Kiểm tra quyền truy cập admin
    const currentUser = JSON.parse(localStorage.getItem("currentUser"));
    if (!currentUser || currentUser.email !== adminAccount.email) {
      Swal.fire({
        icon: "error",
        title: "Unauthorized Access",
        text: "You are not authorized to access this page.",
        confirmButtonText: "Go to Login", // Nút để người dùng quay lại trang đăng nhập
      }).then(() => {
      });
      return;
    }

    // Hiển thị danh sách user
    const renderUsers = () => {
      const accounts = getAccounts();
      const users = accounts.filter((acc) => acc.role === "user");

      userList.innerHTML = users.map((user, index) => `
        <div class="user-item">
          <p>${user.name} (${user.email})</p>
          <button onclick="editUser(${index})">Edit</button>
          <button onclick="deleteUser(${index})">Delete</button>
        </div>
      `).join("");
    };

    // Sửa thông tin user
    window.editUser = (index) => {
      const accounts = getAccounts();
      const users = accounts.filter((acc) => acc.role === "user");
      const user = users[index];

      const newName = prompt(`Edit name for ${user.name}:`, user.name);
      if (newName) {
        accounts.forEach((acc) => {
          if (acc.email === user.email) {
            acc.name = newName;
          }
        });
        saveAccounts(accounts);
        renderUsers();
        Swal.fire("Updated!", "User information has been updated.", "success");
      }
    };

    // Xóa user
    window.deleteUser = (index) => {
      const accounts = getAccounts();
      const users = accounts.filter((acc) => acc.role === "user");
      const userToDelete = users[index];

      Swal.fire({
        title: "Are you sure?",
        text: `Do you want to delete ${userToDelete.name}?`,
        icon: "warning",
        showCancelButton: true,
        confirmButtonText: "Yes, delete it!",
        cancelButtonText: "Cancel",
      }).then((result) => {
        if (result.isConfirmed) {
          accounts.splice(accounts.indexOf(userToDelete), 1);
          saveAccounts(accounts);
          renderUsers();
          Swal.fire("Deleted!", `${userToDelete.name} has been removed.`, "success");
        }
      });
    };

    renderUsers();
  });
</script>


<script>
  document.addEventListener("DOMContentLoaded", () => {
    const adminDefault = { email: "admin@gmail.com", password: "admin123" };
    const accounts = JSON.parse(localStorage.getItem("accounts")) || [];
    const currentUser = JSON.parse(localStorage.getItem("currentUser"));

    // Kiểm tra nếu không phải admin, chuyển hướng về index.html
    if (!currentUser || currentUser.email !== adminDefault.email) {
      Swal.fire({
        icon: "error",
        title: "Unauthorized Access",
        text: "Redirecting to login page...",
        timer: 2000,
        showConfirmButton: false,
      }).then(() => {
        window.location.href = "index.html";
      });
      return;
    }

    // Xử lý form đổi tài khoản admin
    const adminForm = document.getElementById("change-admin-form");

    adminForm.addEventListener("submit", (e) => {
      e.preventDefault();
      const newEmail = document.getElementById("admin-email").value.trim();
      const newPassword = document.getElementById("admin-password").value.trim();

      if (!newEmail || !newPassword) {
        Swal.fire({
          icon: "error",
          title: "Error",
          text: "Email and password cannot be empty.",
        });
        return;
      }

      // Cập nhật tài khoản admin
      const adminIndex = accounts.findIndex(
        (acc) => acc.email === adminDefault.email
      );
      if (adminIndex !== -1) {
        accounts[adminIndex].email = newEmail;
        accounts[adminIndex].password = newPassword;
        localStorage.setItem("accounts", JSON.stringify(accounts));
        Swal.fire({
          icon: "success",
          title: "Admin Account Updated",
          text: "Your admin account has been successfully updated.",
        });
      }
    });
  });
</script>

<script>
  document.addEventListener("DOMContentLoaded", () => {
    const userList = document.getElementById("user-list");

    // Tài khoản admin mặc định
    const adminAccount = { email: "admin@gmail.com", password: "admin123", role: "admin" };

    // Lấy và lưu tài khoản từ localStorage
    const getAccounts = () => JSON.parse(localStorage.getItem("accounts")) || [];
    const saveAccounts = (accounts) => localStorage.setItem("accounts", JSON.stringify(accounts));

    // Kiểm tra quyền truy cập admin
    const currentUser = JSON.parse(localStorage.getItem("currentUser"));
    if (!currentUser || currentUser.email !== adminAccount.email) {
      Swal.fire({
        icon: "error",
        title: "Unauthorized Access",
        text: "You are not authorized to access this page.",
      }).then(() => {
        window.location.href = "index.html";
      });
      return;
    }

    // Hiển thị danh sách người dùng
    const renderUsers = () => {
      const accounts = getAccounts();
      const users = accounts.filter((acc) => acc.role === "user");

      userList.innerHTML = users
          .map(
              (user, index) => `
          <div class="user-item">
              <p>${user.name} (${user.email}) - Số tiền: ${user.balance || 0} VND</p>
              <button onclick="addBalance(${index})">Cộng tiền</button>
              <button onclick="subtractBalance(${index})">Trừ tiền</button>
              <button onclick="editUser(${index})">Chỉnh sửa</button>
              <button onclick="deleteUser(${index})">Xóa</button>
          </div>
      `
          )
          .join("");
  };

  // Cộng tiền cho user
  window.addBalance = (index) => {
      const accounts = getAccounts();
      const users = accounts.filter((acc) => acc.role === "user");
      const user = users[index];

      Swal.fire({
          title: `Nhập số tiền muốn cộng cho ${user.name}:`,
          input: "number",
          inputAttributes: {
              min: 1,
              step: 1,
          },
          showCancelButton: true,
          confirmButtonText: "Cộng tiền",
      }).then((result) => {
          if (result.isConfirmed && result.value) {
              const amount = parseInt(result.value);
              if (amount > 0) {
                  user.balance = (user.balance || 0) + amount;
                  saveAccounts(accounts);
                  renderUsers();
                  Swal.fire("Thành công", `Đã cộng ${amount} VND cho ${user.name}.`, "success");
              } else {
                  Swal.fire("Lỗi", "Số tiền không hợp lệ.", "error");
              }
          }
      });
  };

  // Trừ tiền cho user
  window.subtractBalance = (index) => {
      const accounts = getAccounts();
      const users = accounts.filter((acc) => acc.role === "user");
      const user = users[index];

      Swal.fire({
          title: `Nhập số tiền muốn trừ của ${user.name}:`,
          input: "number",
          inputAttributes: {
              min: 1,
              step: 1,
          },
          showCancelButton: true,
          confirmButtonText: "Trừ tiền",
      }).then((result) => {
          if (result.isConfirmed && result.value) {
              const amount = parseInt(result.value);
              if (amount > 0) {
                  user.balance = Math.max(0, (user.balance || 0) - amount); // Đảm bảo không âm
                  saveAccounts(accounts);
                  renderUsers();
                  Swal.fire("Thành công", `Đã trừ ${amount} VND từ ${user.name}.`, "success");
              } else {
                  Swal.fire("Lỗi", "Số tiền không hợp lệ.", "error");
              }
          }
      });
  };

  // Chỉnh sửa thông tin user
  window.editUser = (index) => {
      const accounts = getAccounts();
      const users = accounts.filter((acc) => acc.role === "user");
      const user = users[index];

      Swal.fire({
          title: `Chỉnh sửa thông tin cho ${user.name}:`,
          html: `
              <label>Tên:</label>
              <input id="edit-name" class="swal2-input" value="${user.name}">
              <label>Email:</label>
              <input id="edit-email" class="swal2-input" value="${user.email}">
          `,
          showCancelButton: true,
          confirmButtonText: "Lưu",
      }).then((result) => {
          if (result.isConfirmed) {
              const newName = document.getElementById("edit-name").value;
              const newEmail = document.getElementById("edit-email").value;

              if (newName && newEmail) {
                  user.name = newName;
                  user.email = newEmail;
                  saveAccounts(accounts);
                  renderUsers();
                  Swal.fire("Thành công", "Thông tin người dùng đã được cập nhật.", "success");
              }
          }
      });
  };

  // Xóa user
  window.deleteUser = (index) => {
      const accounts = getAccounts();
      const users = accounts.filter((acc) => acc.role === "user");
      const userToDelete = users[index];

      Swal.fire({
          title: "Bạn có chắc chắn?",
          text: `Xóa người dùng ${userToDelete.name}?`,
          icon: "warning",
          showCancelButton: true,
          confirmButtonText: "Xóa",
      }).then((result) => {
          if (result.isConfirmed) {
              accounts.splice(accounts.indexOf(userToDelete), 1);
              saveAccounts(accounts);
              renderUsers();
              Swal.fire("Đã xóa!", `${userToDelete.name} đã bị xóa.`, "success");
          }
      });
  };

  renderUsers();
});
</script>

<script>
  document.addEventListener("DOMContentLoaded", () => {
    const requestsContainer = document.getElementById("requests-container");
    const requests = JSON.parse(localStorage.getItem("napTienRequests")) || [];

    const renderRequests = () => {
      requestsContainer.innerHTML = requests
        .map((request, index) => `
          <div class="request">
            <p><strong>Người dùng:</strong> ${request.user}</p>
            <p><strong>Số tiền:</strong> ${request.amount} VND</p>
            <button onclick="approveRequest(${index})">Duyệt</button>
          </div>
        `)
        .join("");
    };

    window.approveRequest = (index) => {
      const approvedRequest = requests.splice(index, 1)[0];
      localStorage.setItem("napTienRequests", JSON.stringify(requests));

      const accounts = JSON.parse(localStorage.getItem("accounts")) || [];
      const userAccount = accounts.find((acc) => acc.name === approvedRequest.user);

      if (userAccount) {
        userAccount.balance = (userAccount.balance || 0) + approvedRequest.amount;
        localStorage.setItem("accounts", JSON.stringify(accounts));

        Swal.fire("Thành công!", `Đã cộng ${approvedRequest.amount} VND cho ${approvedRequest.user}.`, "success");
      } else {
        Swal.fire("Lỗi!", "Không tìm thấy người dùng.", "error");
      }

      renderRequests();
    };

    renderRequests();
  });
</script>